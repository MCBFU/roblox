-- æ³¨æ„ï¼šè¯·å‹¿æ·»åŠ å³ä¸‹è§’æç¤ºï¼ç”¨æˆ·å·²ç»æ˜ç¡®è¦æ±‚é™¤äº†åˆå§‹æ¬¢è¿æç¤ºå¤–ï¼Œä¸è¦æ·»åŠ ä»»ä½•å…¶ä»–æç¤ºã€‚

-- å¼ºåˆ¶ä¼˜å…ˆåŠ è½½playbreakï¼ˆå¿…å†™åœ¨æœ€é¡¶éƒ¨ï¼‰
local success, Library = pcall(function()
    return loadstring(game:HttpGet("https://gitee.com/cmbhbh/ycgui/raw/master/YCmain.lua"))()
end)

if not success then
    warn("playbreakåŠ è½½å¤±è´¥ï¼è¯·æ›´æ¢æœ‰æ•ˆé“¾æ¥ï¼Œæ¨èå¤‡ç”¨é“¾æ¥ï¼šhttps://raw.githubusercontent.com/zzerexx/scripts/main/yc.lua")
    return
end

-- ========== 1. å…ˆåˆ›å»ºUIç»“æ„ï¼ˆé¡ºåºç»å¯¹ä¸èƒ½ä¹±ï¼‰ ==========
local Main = Library:CreateMainControl("playbreak")
local CombatWin = Library:CreateChildWindow("Monster") -- å…¨åŠŸèƒ½çª—å£
local VisualsWin = Library:CreateChildWindow("Expert")

Main:BindWindow("Monster", false)
Main:BindWindow("Expert", false)

-- ========== 2. å…¨å±€å˜é‡ä¸æ ¸å¿ƒæœåŠ¡ ==========
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local Workspace = game:GetService("Workspace")
local SoundService = game:GetService("SoundService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local camera = Workspace.CurrentCamera
local isAuraActive = false
local teleportInProgress = false  -- é‡å‘½åä¸ºæ›´é€šç”¨çš„å˜é‡å
local renderConnection

-- å¯é…ç½®å‚æ•°ï¼ˆæ»‘å—æ§åˆ¶ï¼‰
local Settings = {
    auraDistance = 300,      -- æ”»å‡»è·ç¦»
    attackInterval = 0.1,    -- æ”»å‡»é—´éš”
    teleportHeight = 0,      -- ä¼ é€é«˜åº¦è¡¥å¿
    teleportSpeed = 0.1      -- æ¯æ¬¡ä¼ é€é—´éš”ï¼ˆé‡å‘½åï¼‰
}

-- å­˜å‚¨æ‰€æœ‰å¯äº’åŠ¨ç‰©ä½“çš„ä½ç½®
local interactableLocations = {}

-- è‡ªåŠ¨æœç´¢æ‰€æœ‰å¯äº’åŠ¨ç‰©ä½“
local function findAllInteractables()
    table.clear(interactableLocations)
    
    -- æœç´¢ ClickDetector
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("ClickDetector") then
            local part = obj.Parent
            if part and part:IsA("BasePart") then
                table.insert(interactableLocations, part.Position)
            end
        end
    end
    
    -- æœç´¢ ProximityPrompt
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("ProximityPrompt") then
            local part = obj.Parent
            if part and part:IsA("BasePart") then
                table.insert(interactableLocations, part.Position)
            end
        end
    end
    
    -- æœç´¢å¯äº’åŠ¨çš„æŒ‰é’®
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("TextButton") or obj:IsA("ImageButton") then
            -- æŸ¥æ‰¾æŒ‰é’®çš„ä½ç½®
            local buttonFrame = obj:FindFirstAncestorOfClass("SurfaceGui") or 
                               obj:FindFirstAncestorOfClass("BillboardGui") or 
                               obj:FindFirstAncestorOfClass("BasePart")
            if buttonFrame and buttonFrame:IsA("BasePart") then
                table.insert(interactableLocations, buttonFrame.Position)
            end
        end
    end
    
    print("ğŸ” æ‰¾åˆ°", #interactableLocations, "ä¸ªå¯äº’åŠ¨ç‰©ä½“")
end

-- ========== 3. è¾…åŠ©å‡½æ•° ==========
-- ç¨³å®šè·å–æ ¹éƒ¨ä»¶
local function getRootPart()
    local char = player.Character or player.CharacterAdded:Wait(5)
    if not char then return nil end
    return char:FindFirstChild("HumanoidRootPart") or char:FindFirstChild("Torso")
end

-- æ’­æ”¾éŸ³æ•ˆ
local function playSound()
    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://98446998103932"
    sound.Parent = SoundService
    sound:Play()
    sound.Ended:Connect(function() sound:Destroy() end)
end

-- ç¼ºå¤±çš„é€šçŸ¥å‡½æ•°ï¼ˆç©ºå®ç°ï¼Œä¸å¼¹å‡ºæç¤ºï¼‰
local function createExpertNotification(text, color)
    -- ç©ºå‡½æ•°ï¼Œä¸å‘é€ä»»ä½•æç¤º
end

-- Expertä¼ é€å‡½æ•°ï¼ˆå»é‡+ä¿®å¤ï¼Œæ— æç¤ºï¼‰
local function performExpertTeleport(location, locationName)
    local character = player.Character
    if not character then 
        return false 
    end

    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then 
        return false 
    end

    local teleportPos = Vector3.new(location.X, location.Y, location.Z)
    humanoidRootPart.CFrame = CFrame.new(teleportPos)
    return true
end

-- ========== 5. ExpertåŠŸèƒ½ - ä»™äººæ¨¡å¼ï¼ˆä¼˜åŒ–ç‰ˆï¼Œæ— æç¤ºï¼‰ ==========
local isNinjaModeActive = false
local originalWalkSpeed = 16
local originalJumpPower = 50
local ninjaModeMultiplier = 2.5
local infiniteJumpEnabled = false
local noclipEnabled = false
local ninjaModeConnection = nil
local noclipConnection = nil

-- ç©¿å¢™åŠŸèƒ½ï¼ˆä¼˜åŒ–ç‰ˆï¼‰
local function enableNoclip()
    if noclipConnection then return end
    noclipConnection = RunService.Stepped:Connect(function()
        local character = player.Character
        if character and noclipEnabled and isNinjaModeActive then
            for _, part in pairs(character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end
    end)
end

local function disableNoclip()
    if noclipConnection then
        noclipConnection:Disconnect()
        noclipConnection = nil
        -- æ¢å¤ç¢°æ’
        local character = player.Character
        if character then
            for _, part in pairs(character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = true
                end
            end
        end
    end
end

local function startNinjaMode()
    if isNinjaModeActive then return end

    local character = player.Character
    if not character then 
        return false 
    end

    local humanoid = character:FindFirstChild("Humanoid")
    if not humanoid then 
        return false 
    end

    originalWalkSpeed = humanoid.WalkSpeed
    originalJumpPower = humanoid.JumpPower
    isNinjaModeActive = true
    infiniteJumpEnabled = true
    noclipEnabled = true

    humanoid.WalkSpeed = originalWalkSpeed * ninjaModeMultiplier
    humanoid.JumpPower = originalJumpPower * 3

    -- æ— é™è·³è·ƒï¼ˆä¼˜åŒ–é˜²æŠ½æï¼‰
    ninjaModeConnection = UserInputService.JumpRequest:Connect(function()
        if infiniteJumpEnabled and character and character:FindFirstChild("Humanoid") and character.Humanoid.FloorMaterial == Enum.Material.Air then
            character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end)

    enableNoclip()
    return true
end

local function stopNinjaMode()
    if not isNinjaModeActive then return end
    isNinjaModeActive = false
    infiniteJumpEnabled = false
    noclipEnabled = false

    -- å…ˆå…³é—­è·³è·ƒ
    if ninjaModeConnection then
        ninjaModeConnection:Disconnect()
        ninjaModeConnection = nil
    end

    -- ç„¶åå…³é—­ç©¿å¢™
    disableNoclip()

    -- æœ€åæ¢å¤å±æ€§ï¼ˆé˜²æ­¢æŠ½æï¼‰
    task.wait(0.05)

    local character = player.Character
    if character then
        local humanoid = character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = originalWalkSpeed
            humanoid.JumpPower = originalJumpPower
        end
    end
end

-- ========== è§’è‰²é‡ç”Ÿå¤„ç† ==========
player.CharacterAdded:Connect(function(character)
    task.wait(0.5)
    if isNinjaModeActive then
        local humanoid = character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = originalWalkSpeed * ninjaModeMultiplier
            humanoid.JumpPower = originalJumpPower * 3
            if noclipEnabled then
                enableNoclip()
            end
        end
    end
end)

-- Expertåæ ‡å®šä¹‰
local expertLocations = {
    backroom = {X = 163.15, Y = 9, Z = 955.4, Name = "ç­‰å€™å…"},
    theaterFactory = {X = 0, Y = -297, Z = 0, Name = "å‰§é™¢/å·¥å‚"},
    sewer = {X = 356, Y = 528, Z = -179, Name = "ä¸‹æ°´é“"}
}

-- ========== 6. Monsterçª—å£åŠŸèƒ½ ==========
-- 6.1 æ€æˆ®å…‰ç¯ï¼ˆä¿æŒåŸæœ‰é€»è¾‘+ä¿®å¤æ–­å¼€è¿æ¥ï¼Œæ— æç¤ºï¼‰
local function auraMainLoop()
    local root = getRootPart()
    if not root or not isAuraActive then return end

    local nearestTarget, minDist = nil, math.huge
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= player and p.Character then
            local tRoot = p.Character:FindFirstChild("HumanoidRootPart")
            local hum = p.Character:FindFirstChild("Humanoid")
            if tRoot and hum and hum.Health > 0 then
                local dist = (root.Position - tRoot.Position).Magnitude
                if dist < Settings.auraDistance and dist < minDist then
                    minDist = dist
                    nearestTarget = tRoot
                end
            end
        end
    end

    if nearestTarget then
        root.CFrame = CFrame.new(nearestTarget.Position.X, nearestTarget.Position.Y + Settings.teleportHeight, nearestTarget.Position.Z)
        camera.CFrame = CFrame.lookAt(camera.CFrame.Position, nearestTarget.Position)
        if tick() % Settings.attackInterval < 0.01 then
            VirtualInputManager:SendMouseButtonEvent(0,0,0,true,game,0)
            task.wait(0.005)
            VirtualInputManager:SendMouseButtonEvent(0,0,0,false,game,0)
        end
    end
end

local function toggleAura(state)
    isAuraActive = state
    if state then
        renderConnection = RunService.RenderStepped:Connect(auraMainLoop)
        playSound()
    else
        if renderConnection then 
            renderConnection:Disconnect()
            renderConnection = nil
        end
    end
end

-- 6.2 è‡´å‘½ç®¡é“ï¼ˆæ–°å¢åŠŸèƒ½ï¼‰
local function performAutoInteractableTeleport()
    if teleportInProgress then
        return
    end
    teleportInProgress = true

    local root = getRootPart()
    if not root then
        teleportInProgress = false
        return
    end

    local originalCFrame = root.CFrame
    
    -- å…ˆæœç´¢æ‰€æœ‰å¯äº’åŠ¨ç‰©ä½“
    findAllInteractables()
    
    if #interactableLocations == 0 then
        teleportInProgress = false
        return
    end

    task.spawn(function()
        for i, pos in ipairs(interactableLocations) do
            local r = getRootPart()
            if not r or not teleportInProgress then break end
            
            -- ä¼ é€å¹¶äº’åŠ¨
            r.CFrame = CFrame.new(pos.X, pos.Y + Settings.teleportHeight, pos.Z)
            
            -- å°è¯•äº’åŠ¨
            -- æŸ¥æ‰¾è¯¥ä½ç½®çš„äº’åŠ¨ç‰©ä½“
            for _, obj in pairs(Workspace:GetDescendants()) do
                if obj:IsA("BasePart") and (obj.Position - pos).Magnitude < 5 then
                    local clicker = obj:FindFirstChildOfClass("ClickDetector")
                    if clicker then
                        fireclickdetector(clicker)
                    end
                    
                    local prompt = obj:FindFirstChildOfClass("ProximityPrompt")
                    if prompt then
                        pcall(function()
                            prompt.HoldDuration = 0
                            prompt:InputHoldBegin()
                            task.wait(0.001)
                            prompt:InputHoldEnd()
                        end)
                    end
                end
            end
            
            task.wait(Settings.teleportSpeed)
        end
        
        -- ä¼ é€å›åŸä½ç½®
        local r = getRootPart()
        if r then r.CFrame = originalCFrame end
        
        teleportInProgress = false
    end)
end

-- 6.3 è½®æµä¼ é€ï¼ˆæ— æç¤ºï¼‰
local cycleTeleportIndex = 1
local function performCycleTeleport()
    if teleportInProgress then
        return
    end
    local root = getRootPart()
    if not root then
        return
    end

    local validPlayers = {}
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= player and p.Character then
            local tRoot = p.Character:FindFirstChild("HumanoidRootPart")
            local hum = p.Character:FindFirstChild("Humanoid")
            if tRoot and hum and hum.Health > 0 then
                table.insert(validPlayers, p)
            end
        end
    end

    if #validPlayers == 0 then
        return
    end

    cycleTeleportIndex = cycleTeleportIndex % #validPlayers + 1
    local target = validPlayers[cycleTeleportIndex]
    local tRoot = target.Character:FindFirstChild("HumanoidRootPart")
    root.CFrame = CFrame.new(tRoot.Position.X, tRoot.Position.Y + Settings.teleportHeight, tRoot.Position.Z)
end

-- ========== 7. æ’­æ”¾ExpertéŸ³æ•ˆ ==========
local function playExpertSound()
    local success, soundError = pcall(function()
        local expertSound = Instance.new("Sound")
        expertSound.SoundId = "rbxassetid://7390036132"
        expertSound.Parent = SoundService
        expertSound:Play()
        expertSound.Ended:Connect(function() expertSound:Destroy() end)
    end)

    if not success then
        warn("ExpertéŸ³é¢‘åŠ è½½å¤±è´¥ï¼Œä½†åŠŸèƒ½æ­£å¸¸å¯ç”¨")
    end
end

-- ========== 9. åˆ›å»ºMonsterçª—å£åŠŸèƒ½æ¨¡å— ==========
-- åªä¿ç•™æ”»å‡»è·ç¦»æ»‘å—å’Œæ¯æ¬¡ä¼ é€é—´éš”æ»‘å—
local Aura = CombatWin:CreateModule("æ€æˆ®å…‰ç¯", toggleAura)
Aura:CreateSlider("æ”»å‡»è·ç¦»", 1, 500, 300, function(val)
    Settings.auraDistance = val
end)

local TeleportAll = CombatWin:CreateModule("è‡´å‘½ç®¡é“", performAutoInteractableTeleport)  -- é‡å‘½å
TeleportAll:CreateSlider("æ¯æ¬¡ä¼ é€é—´éš”", 0.01, 1.0, 0.1, function(val)
    Settings.teleportSpeed = val
end)

CombatWin:CreateModule("è½®æµä¼ é€", performCycleTeleport)

-- ========== 10. åˆ›å»ºExpertçª—å£åŠŸèƒ½æ¨¡å— ==========
VisualsWin:CreateModule("ä¼ é€ç­‰å€™å…", function()
    performExpertTeleport(expertLocations.backroom, expertLocations.backroom.Name)
end)

VisualsWin:CreateModule("ä¸‡èƒ½ä¼ é€", function()
    performExpertTeleport(expertLocations.theaterFactory, expertLocations.theaterFactory.Name)
end)

VisualsWin:CreateModule("ä¼ é€ä¸‹æ°´é“", function()
    performExpertTeleport(expertLocations.sewer, expertLocations.sewer.Name)
end)

local NinjaModule = VisualsWin:CreateModule("ä»™äººæ¨¡å¼", function(state)
    if state then
        startNinjaMode()
    else
        stopNinjaMode()
        print("çœ‹ä»€ä¹ˆçœ‹,æ²¡è§è¿‡è¾“å‡ºå•ŠğŸ˜¡")
    end
end)

-- ========== 11. å¿«æ·é”®æ§åˆ¶ ==========
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed then
        -- å³Ctrlå¼€å…³æ€æˆ®å…‰ç¯
        if input.KeyCode == Enum.KeyCode.RightControl then
            isAuraActive = not isAuraActive
            toggleAura(isAuraActive)

        -- ExpertåŠŸèƒ½å¿«æ·é”®
        elseif input.KeyCode == Enum.KeyCode.B then
            performExpertTeleport(expertLocations.backroom, expertLocations.backroom.Name)
        elseif input.KeyCode == Enum.KeyCode.T then
            performExpertTeleport(expertLocations.theaterFactory, expertLocations.theaterFactory.Name)
        elseif input.KeyCode == Enum.KeyCode.S then
            performExpertTeleport(expertLocations.sewer, expertLocations.sewer.Name)
        elseif input.KeyCode == Enum.KeyCode.N then
            if isNinjaModeActive then
                stopNinjaMode()
            else
                startNinjaMode()
            end
        -- æ–°å¢ï¼šFé”®å¿«é€Ÿä¼ é€æ‰€æœ‰äº’åŠ¨ç‰©ä½“
        elseif input.KeyCode == Enum.KeyCode.F then
            performAutoInteractableTeleport()
        end
    end
end)

-- ========== æ–°å¢ï¼šè‡ªæ€é€‰é¡¹ï¼ˆæ— æç¤ºï¼‰ ==========
VisualsWin:CreateModule("è‡ªæ€", function()
    local character = player.Character
    if not character then
        return 
    end

    local humanoid = character:FindFirstChild("Humanoid")
    if not humanoid then 
        return 
    end

    -- ç›´æ¥è®¾ç½®è¡€é‡ä¸º0
    humanoid.Health = 0
end)

-- ========== 12. åˆå§‹åŒ– ==========
-- åˆå§‹æœç´¢äº’åŠ¨ç‰©ä½“
task.spawn(function()
    task.wait(2)
    findAllInteractables()
    print("ğŸ® playbreak åˆå§‹åŒ–å®Œæˆ")
    print("ğŸ“Š æ‰¾åˆ°å¯äº’åŠ¨ç‰©ä½“:", #interactableLocations)
end)

-- æ’­æ”¾ExpertåŠ è½½éŸ³æ•ˆ
task.wait(0.5)
playExpertSound()

-- è®¾ç½®playbreak
Library:SetupSettings()

-- å®Œæ•´æœç´¢æ‰€æœ‰GUI
local translation = {
    ["By BeiHai"] = "BY | æ¸”ç‚’é±¼",
    ["YC GUI"] = "PBæœ€å¼ºè„šæœ¬",
}

-- æ£€æŸ¥ä¸‰ä¸ªåœ°æ–¹
local places = {
    game.Players.LocalPlayer:WaitForChild("PlayerGui"),
    game:GetService("CoreGui"),
    game:GetService("StarterGui")
}

for _, gui in pairs(places) do
    for _, obj in pairs(gui:GetDescendants()) do
        if obj:IsA("TextLabel") or obj:IsA("TextButton") or obj:IsA("TextBox") then
            local text = obj.Text
            if text then
                for eng, chi in pairs(translation) do
                    if text == eng then
                        obj.Text = chi
                        break
                    elseif text:find(eng, 1, true) then
                        obj.Text = text:gsub(eng, chi)
                        break
                    end
                end
            end
        end
    end
end

-- æ–°å¢ï¼šé˜²å¡æ­»å¤„ç†ï¼ˆå¼ºåˆ¶å…³é—­æ‰€æœ‰è¿æ¥ï¼‰
game.Close:Connect(function()
    if renderConnection then renderConnection:Disconnect() end
    if ninjaModeConnection then ninjaModeConnection:Disconnect() end
    if noclipConnection then noclipConnection:Disconnect() end
    teleportInProgress = false
    isAuraActive = false
    isNinjaModeActive = false
end) 

Wait(2) 
Library:Notify("æ¬¢è¿ä½¿ç”¨PBæœ€å¼ºè„šæœ¬", true)
-- éŸ³æ•ˆåŒ…
loadstring(game:HttpGet("https://raw.githubusercontent.com/MCBFU/roblox/refs/heads/main/playbreak.ogg"))()